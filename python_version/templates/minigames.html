{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Game Center" %}{% endblock %}

{% block extra_css %}
{{ block.super }}
<style>
    body {
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 25%, #334155 50%, #1e293b 75%, #0f172a 100%);
        background-size: 400% 400%;
        animation: gradientShift 20s ease infinite;
    }
    
    @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }
    
    .games-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem 1rem;
    }
    
    .page-hero {
        text-align: center;
        margin-bottom: 3rem;
    }
    
    .section-title {
        font-size: 2.5rem;
        font-weight: 800;
        background: linear-gradient(135deg, #fff 0%, #e2e8f0 50%, #cbd5e1 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.5rem;
    }
    
    .section-subtitle {
        color: rgba(226, 232, 240, 0.7);
        font-size: 1.1rem;
    }
    
    .filter-card {
        background: rgba(30, 41, 59, 0.8);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 2rem;
        margin-bottom: 2rem;
        border: 1px solid rgba(148, 163, 184, 0.2);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }
    
    .game-card {
        background: rgba(30, 41, 59, 0.8);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 2rem;
        height: 100%;
        border: 1px solid rgba(148, 163, 184, 0.2);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    
    .game-card:hover {
        transform: translateY(-8px) scale(1.02);
        border-color: rgba(102, 126, 234, 0.5);
        box-shadow: 0 20px 60px rgba(102, 126, 234, 0.4);
    }
    
    .game-icon {
        font-size: 4rem;
        margin-bottom: 1.5rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .game-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: #f1f5f9;
        margin-bottom: 1rem;
    }
    
    .game-description {
        color: #94a3b8;
        font-size: 1rem;
        line-height: 1.6;
        margin-bottom: 1.5rem;
        min-height: 3em;
    }
    
    .player-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1.25rem;
        border-radius: 25px;
        font-size: 0.95rem;
        font-weight: 600;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        margin-bottom: 1.5rem;
    }
    
    .btn-game {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 12px;
        font-weight: 600;
        transition: all 0.3s ease;
        width: 100%;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
    }
    
    .btn-game:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.5);
        color: white;
    }
    
    .form-control, .form-select {
        background-color: rgba(51, 65, 85, 0.6);
        border-color: rgba(148, 163, 184, 0.2);
        color: #f1f5f9;
    }
    
    .form-control:focus, .form-select:focus {
        background-color: rgba(51, 65, 85, 0.8);
        border-color: #667eea;
        color: #f1f5f9;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
    }
    
    .form-label {
        color: #cbd5e1;
        font-weight: 600;
        margin-bottom: 0.5rem;
    }
    
    .result-count {
        color: #94a3b8;
        font-size: 1rem;
        margin-bottom: 1.5rem;
    }
    
    .empty-state {
        background: rgba(30, 41, 59, 0.6);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 4rem 2rem;
        text-align: center;
        border: 2px dashed rgba(102, 126, 234, 0.3);
    }
    
    .empty-icon {
        font-size: 5rem;
        margin-bottom: 1rem;
        opacity: 0.5;
        color: #94a3b8;
    }
    
    @media (max-width: 768px) {
        .section-title {
            font-size: 2rem;
        }
        
        .filter-card {
            padding: 1.5rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="games-container">
    <div class="page-hero">
        <h1 class="section-title">
            <i class="fas fa-gamepad me-2"></i>{% trans "Game Center" %}
        </h1>
        <p class="section-subtitle">{% trans "Select the game you want to play" %}</p>
    </div>

    <!-- Filtering and Search Section -->
    <div class="filter-card">
        <form method="get" action="{% url 'all_games_lobby' %}" class="row g-3">
            <!-- Search -->
            <div class="col-md-4">
                <label for="search" class="form-label">
                    <i class="fas fa-search"></i> {% trans "Search Game" %}
                </label>
                <input type="text" 
                       class="form-control" 
                       id="search" 
                       name="search" 
                       placeholder="{% trans 'Game name or description...' %}"
                       value="{{ search_query }}">
            </div>

            <!-- Min Players -->
            <div class="col-md-2">
                <label for="min_players" class="form-label">
                    <i class="fas fa-users"></i> {% trans "Min Players" %}
                </label>
                <input type="number" 
                       class="form-control" 
                       id="min_players" 
                       name="min_players" 
                       min="1" 
                       max="10"
                       placeholder="{% trans 'Min' %}"
                       value="{{ min_players_filter }}">
            </div>

            <!-- Max Players -->
            <div class="col-md-2">
                <label for="max_players" class="form-label">
                    <i class="fas fa-users"></i> {% trans "Max Players" %}
                </label>
                <input type="number" 
                       class="form-control" 
                       id="max_players" 
                       name="max_players" 
                       min="1" 
                       max="10"
                       placeholder="{% trans 'Max' %}"
                       value="{{ max_players_filter }}">
            </div>

            <!-- Sort -->
            <div class="col-md-2">
                <label for="sort" class="form-label">
                    <i class="fas fa-sort"></i> {% trans "Sort" %}
                </label>
                <select class="form-select" id="sort" name="sort">
                    <option value="name" {% if sort_by == 'name' %}selected{% endif %}>{% trans "By Name" %}</option>
                    <option value="players" {% if sort_by == 'players' %}selected{% endif %}>{% trans "By Player Count" %}</option>
                </select>
            </div>

            <!-- Buttons -->
            <div class="col-md-2 d-flex align-items-end">
                <button type="submit" class="btn btn-primary w-100 me-2">
                    <i class="fas fa-filter"></i> {% trans "Filter" %}
                </button>
                <a href="{% url 'all_games_lobby' %}" class="btn btn-secondary">
                    <i class="fas fa-times"></i>
                </a>
            </div>
        </form>

        <!-- Active Filters Indicator -->
        {% if search_query or min_players_filter or max_players_filter %}
        <div class="mt-3">
            <small class="text-muted">{% trans "Active Filters:" %} </small>
            {% if search_query %}
                <span class="badge bg-info me-1">
                    {% trans "Search" %}: "{{ search_query }}"
                    <a href="?{% if min_players_filter %}min_players={{ min_players_filter }}&{% endif %}{% if max_players_filter %}max_players={{ max_players_filter }}&{% endif %}{% if sort_by %}sort={{ sort_by }}{% endif %}" 
                       class="text-white ms-1" style="text-decoration: none;">×</a>
                </span>
            {% endif %}
            {% if min_players_filter %}
                <span class="badge bg-info me-1">
                    {% trans "Min" %}: {{ min_players_filter }}
                    <a href="?{% if search_query %}search={{ search_query }}&{% endif %}{% if max_players_filter %}max_players={{ max_players_filter }}&{% endif %}{% if sort_by %}sort={{ sort_by }}{% endif %}" 
                       class="text-white ms-1" style="text-decoration: none;">×</a>
                </span>
            {% endif %}
            {% if max_players_filter %}
                <span class="badge bg-info me-1">
                    {% trans "Max" %}: {{ max_players_filter }}
                    <a href="?{% if search_query %}search={{ search_query }}&{% endif %}{% if min_players_filter %}min_players={{ min_players_filter }}&{% endif %}{% if sort_by %}sort={{ sort_by }}{% endif %}" 
                       class="text-white ms-1" style="text-decoration: none;">×</a>
                </span>
            {% endif %}
        </div>
        {% endif %}
    </div>

    <!-- Result Count -->
    <div class="result-count">
        <strong>{{ minigames_list|length }}</strong> {% trans "games found" %}
    </div>

    <div class="row g-4">
        {% for game in minigames_list %}
        <div class="col-lg-4 col-md-6">
            <div class="game-card">
                <div class="game-icon">
                    <i class="fas fa-dice-d20"></i>
                </div>
                <h3 class="game-title">{{ game.name }}</h3>
                <p class="game-description">
                    {{ game.description|default:_("No description available for this game.") }}
                </p>
                <span class="player-badge">
                    <i class="fas fa-users"></i>
                    {{ game.min_players }} - {{ game.max_players }} {% trans "Players" %}
                </span>
                <a href="{% url 'game_specific_lobby' game.slug %}" class="btn-game">
                    {% trans "Go to" %} {{ game.name }} {% trans "Lobby" %}
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="empty-state">
                <div class="empty-icon">
                    <i class="fas fa-search"></i>
                </div>
                <h3 style="color: #f1f5f9; margin-bottom: 1rem;">{% trans "No Games Found" %}</h3>
                <p style="color: #94a3b8;">{% trans "No playable games are available in the system yet." %}</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
